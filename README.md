# Trals-of-cold-steel-translation-tools
Инструменты для перевода игры Legend of hero: Trails of the Cold Steel

book.pyw - скрипт для разбора *.dat файлов. Работает следующим образом: распаковывает *.dat файл в папку с имнем файла, после чего полученные файлы можно переводить,
модифицировать, редактировать в hex- или текстовом редакторе. Единственная проблема - при переоде имен необходимо оставлять изначальную длину имени в байтах, если
имя короче: дополнять пробелами, а если длинее: пытаться как-то сократить. Над посиком поля, где прописана длина имени, бились несколько человек, но так найти не смогли.
Если вдруг у кого-то получится это сделать, обязательно сообщите.

book2dat.pyw - скрипт для обратной упаковки *.dat файлов в понятный игре вид. Работает так: выбирается папка с распакованным *.dat-файлом, создается новый DAT-файл
с прпиской _new в конце.

font_tools.au3 - позволяет работать со шрифтами из игры. Принцип работы такой: выбирается файл со шритфом, а на выходе дается XML-таблица и перестроенный шрифт с постфиксом
_new. Таблица содержит данные, удобные для последующей модификации шрифта с помощью любого hex-редактора. А именно: 'Символ', 'Смещение', 'Смещение2', 'Ширина', 'Высота', 
'Отступ сверху', 'Отступ слева', 'Отступ справа', 'Тип'. Смещение один - смещение до названия буквы, смещение два - смещение до данных буквы, гда первые 12 байт это 
параметры (указаны в последующих столбцах таблицы), а затем идет сама буква в формате 4-битного инвертированного BMP. Чтобы изменить параметры буквы\символа\знака, нужно
перейти к смещению 2 в файле шрифта и изменить один из 6-ти параметров вручную, каждый из них занимает 2 байта. В ново-созданном шрифте с припиской _new можно изменить
одну буквы на другую. В частности, мы это использовали для "перевода" кириллицы в ASCII формат, так как игра не поддерживает Юникод в некоторых элементах интерфейса. 
Мы просто заменили смещения букв латиницы на смещение к буквам кириллицы. В строке 77 список символов, подлежащих замене, в строке 78 указывается список символов, 
которыми будут заменены символы из строки 77.

t_item.au3 и t_item.py - скрипты для разбора файла t_item.tbl. Функционал идентичен, преобразовывают игровой файл в читаемый текст, который можно переводить. Вариант
на пайтоне недоработан, по этому, пользоваться лучше скриптом на AutoIt.

t_item_txt2tbl.au3 - "упаковывает" текстовый файл обратно в t_item.tbl.

t_text_fix.py - "упаковывает" текстовый файл обратно в t_text.tbl.

tbl_mass_conv.py - конвертер TBL в текст и обратно. Поддерживает упаковку\распаковку t_text.tbl и только упаковку t_item.tbl. Для останльный файлов функционал находится
в процессе создания. Использование пока замороченное, в строках 113 и 114 нужно указать класс, метод и файл. Планируется добаить интерфейс, либо просто диалог выбора
файла с автоматическим определением его типа.

yes_no_fixer.au3 - скрипт для массовой замены одного хекс кода на другой хекс код. Использовался, в основном, для поиска и замены меню типа ДА\НЕТ, так как вручную
искать такие короткие слова в куче файлов крайне затруднительно. Пользоваться так: в строках 9 и 10 указываются папки входная и выходная соответственно, в строках 28
и 29 указываются код для поиска и для замены соответственно.

локации по файлам.txt - список локаций игры с указанием файла, который отвечает за данную локацию.

строение файлов сцен.txt - краткое описание внутреннего устройства DAT-файлов.

